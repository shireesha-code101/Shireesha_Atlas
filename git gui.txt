package com.elibrary.inventory;

import java.util.ArrayList;
import java.util.List;
import java.util.Optional;
import java.util.Iterator;

import com.elibrary.exception.ISBNAlreadyExistsException;
import com.elibrary.models.Book;

public class Inventory {

    private List<Book> books = new ArrayList<>();

    public void addBook(Book book) throws ISBNAlreadyExistsException {
        for (Book existingBook : books) {
            if (existingBook.getIsbn().equals(book.getIsbn())) {
                throw new ISBNAlreadyExistsException("Book with the same ISBN already exists.");
            }
        }
        books.add(book);
        System.out.println("Book added successfully.");
    }

    public Optional<Book> getBookByName(String name) {
        for (Book book : books) {
            if (book.getTitle().equalsIgnoreCase(name)) {
                return Optional.of(book);
            }
        }
        return Optional.empty();
    }

    public Book updateBook(Book updatedBook) {
        for (int i = 0; i < books.size(); i++) {
            if (books.get(i).getIsbn().equals(updatedBook.getIsbn())) {
                books.set(i, updatedBook);
                System.out.println("Book updated successfully.");
                return updatedBook;
            }
        }
        System.out.println("Book not found for update.");
        return null;
    }

    public List<Book> getAllBooks() {
        return new ArrayList<>(books);
    }

    public boolean isBookAvailable(String isbn) {
        for (Book book : books) {
            if (book.getIsbn().equals(isbn)) {
                return book.isAvailable();
            }
        }
        return false;
    }
}
